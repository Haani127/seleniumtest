package runner;

import java.io.IOException;
import java.time.Duration;

import org.openqa.selenium.By;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.AfterTest;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.Test;

import com.aventstack.extentreports.ExtentReports;
import com.aventstack.extentreports.ExtentTest;
import com.aventstack.extentreports.Status;
import com.aventstack.extentreports.model.ScreenCapture;

import utils.Base;
import utils.ExcelReader;
import utils.LoggerHandler;
import utils.Reporter;
import utils.Screenshot;
import utils.WebDriverHelper;

public class TestRunner extends Base {
    
    WebDriverHelper helper;
    ExtentReports reports;
    ExtentTest test;
    @BeforeTest
    void b1() {
        reports = Reporter.generateExtentReport("reports");
    }
    @BeforeMethod
    public void beforemethod(){
        helper=new WebDriverHelper(driver);
        openBrowser();

    }

    @Test
    public void test() throws IOException{
        test = reports.createTest("test1");
        test.log(Status.INFO,"click on property" );
        LoggerHandler.info("click on element");
        helper.clickOnElement(By.xpath("//*[@id=\"lodging_search_form\"]/div/div/div[1]/div/div/div[1]/button"));
        helper.sendKeys(By.xpath("//*[@id=\"lodging_search_form\"]/div/div/div[1]/div/div/div[1]/button"), "Coimbatore");
        helper.clickOnElement(By.xpath("//*[@id=\"lodging_search_form\"]/div/div/div[2]/div/div/div[1]/div/div/button"));
        helper.clickOnElement(By.xpath("//*[@id=\"app-layer-uitk-date-selector-dialog-dialog-2\"]/section/div[3]/div[4]/div/div/div/div/div[1]/table/tbody/tr[1]/td[3]/div/div[2]"));
        Reporter.captureScreenShot("screenshot1"); 
        Screenshot.captureScreenShot("screenshot1");  
        driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));
        // 
        String data = ExcelReader.readdata("./data/data.xlsx", "sheet1", 0, 0); 
        
        By e1 = By.xpath("");
        helper.javascriptScroll(e1);
        helper.switchToNewWindow();
    }

    


    @AfterMethod
    public void aftermethod(){
        driver.quit();
    }
    @AfterTest
    public void aftertest(){
        reports.flush();
    }
}